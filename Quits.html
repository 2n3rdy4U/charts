<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        * {{
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }}
        html, body {{
            width: 100%;
            height: 100%;
            overflow: hidden;
        }}
        #vis {{
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
        }}
        #vis .vega-embed {{
            width: 100% !important;
            flex: 1;
        }}
        #vis .vega-embed details {{
            position: absolute;
            right: 5px;
            top: 5px;
        }}
        /* Style the radio buttons */
        .vega-bindings {{
            padding: 5px 0 10px 0;
            font-family: Georgia, serif;
            font-size: 13px;
        }}
        .vega-bind {{
            padding: 2px 0;
        }}
        .vega-bind-name {{
            font-weight: normal;
            color: #555;
        }}
        .vega-bind input[type="radio"] {{
            margin: 0 3px 0 8px;
        }}
        /* Preset buttons */
        #preset-buttons button {
            background: #fff;
            border: 1px solid #ddd;
            padding: 6px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-family: Georgia, serif;
            color: #2c3e50;
        }
        #preset-buttons button.active {
            background: #2E86AB;
            color: white;
            border-color: #2E86AB;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
</head>
<body>
    <div id="controls" style="padding:8px 0 12px 0; font-family: Georgia, serif; display:flex; gap:8px; align-items:center;">
        <div id="preset-buttons">
            <button data-range="1">1M</button>
            <button data-range="3">3M</button>
            <button data-range="12">1Y</button>
            <button data-range="60">5Y</button>
            <button data-range="all">All</button>
        </div>
        <span id="range-label" style="margin-left:12px;color:#555;font-size:13px;"></span>
    </div>
    <div id="vis"></div>
    <script>
        const originalSpec = {
  "$schema": "https://vega.github.io/schema/vega-lite/v6.1.0.json",
  "config": {
    "axisX": {
      "grid": false,
      "labelFont": "Georgia, serif",
      "titleFont": "Georgia, serif"
    },
    "axisY": {
      "grid": true,
      "labelFont": "Georgia, serif",
      "titleFont": "Georgia, serif"
    },
    "title": {
      "font": "Georgia, serif"
    },
    "view": {
      "continuousHeight": 300,
      "continuousWidth": 300
    }
  },
  "data": {
    "name": "data-5a5ffa9cd51c1803967298662d1bba95"
  },
  "datasets": {
    "data-5a5ffa9cd51c1803967298662d1bba95": [
      {
        "date": "2016-01-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.0
      },
      {
        "date": "2016-02-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.1
      },
      {
        "date": "2016-03-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.0
      },
      {
        "date": "2016-04-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.1
      },
      {
        "date": "2016-05-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.1
      },
      {
        "date": "2016-06-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.1
      },
      {
        "date": "2016-07-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.1
      },
      {
        "date": "2016-08-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.1
      },
      {
        "date": "2016-09-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.1
      },
      {
        "date": "2016-10-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.1
      },
      {
        "date": "2016-11-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.1
      },
      {
        "date": "2016-12-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.1
      },
      {
        "date": "2017-01-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.2
      },
      {
        "date": "2017-02-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.1
      },
      {
        "date": "2017-03-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.2
      },
      {
        "date": "2017-04-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.1
      },
      {
        "date": "2017-05-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.1
      },
      {
        "date": "2017-06-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.2
      },
      {
        "date": "2017-07-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.1
      },
      {
        "date": "2017-08-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.1
      },
      {
        "date": "2017-09-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.2
      },
      {
        "date": "2017-10-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.2
      },
      {
        "date": "2017-11-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.2
      },
      {
        "date": "2017-12-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.2
      },
      {
        "date": "2018-01-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.0
      },
      {
        "date": "2018-02-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.2
      },
      {
        "date": "2018-03-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.2
      },
      {
        "date": "2018-04-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.3
      },
      {
        "date": "2018-05-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.3
      },
      {
        "date": "2018-06-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.3
      },
      {
        "date": "2018-07-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.3
      },
      {
        "date": "2018-08-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.3
      },
      {
        "date": "2018-09-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.3
      },
      {
        "date": "2018-10-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.3
      },
      {
        "date": "2018-11-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.3
      },
      {
        "date": "2018-12-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.3
      },
      {
        "date": "2019-01-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.3
      },
      {
        "date": "2019-02-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.4
      },
      {
        "date": "2019-03-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.3
      },
      {
        "date": "2019-04-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.3
      },
      {
        "date": "2019-05-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.3
      },
      {
        "date": "2019-06-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.3
      },
      {
        "date": "2019-07-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.4
      },
      {
        "date": "2019-08-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.3
      },
      {
        "date": "2019-09-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.3
      },
      {
        "date": "2019-10-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.3
      },
      {
        "date": "2019-11-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.3
      },
      {
        "date": "2019-12-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.3
      },
      {
        "date": "2020-01-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.3
      },
      {
        "date": "2020-02-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.3
      },
      {
        "date": "2020-03-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 1.9
      },
      {
        "date": "2020-04-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 1.5
      },
      {
        "date": "2020-05-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 1.7
      },
      {
        "date": "2020-06-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 1.9
      },
      {
        "date": "2020-07-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.2
      },
      {
        "date": "2020-08-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.1
      },
      {
        "date": "2020-09-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.2
      },
      {
        "date": "2020-10-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.3
      },
      {
        "date": "2020-11-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.2
      },
      {
        "date": "2020-12-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.4
      },
      {
        "date": "2021-01-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.3
      },
      {
        "date": "2021-02-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.4
      },
      {
        "date": "2021-03-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.5
      },
      {
        "date": "2021-04-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.7
      },
      {
        "date": "2021-05-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.6
      },
      {
        "date": "2021-06-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.7
      },
      {
        "date": "2021-07-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.7
      },
      {
        "date": "2021-08-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.8
      },
      {
        "date": "2021-09-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.9
      },
      {
        "date": "2021-10-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.8
      },
      {
        "date": "2021-11-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 3.0
      },
      {
        "date": "2021-12-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.9
      },
      {
        "date": "2022-01-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.9
      },
      {
        "date": "2022-02-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.9
      },
      {
        "date": "2022-03-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 3.0
      },
      {
        "date": "2022-04-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.9
      },
      {
        "date": "2022-05-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.8
      },
      {
        "date": "2022-06-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.7
      },
      {
        "date": "2022-07-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.6
      },
      {
        "date": "2022-08-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.7
      },
      {
        "date": "2022-09-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.7
      },
      {
        "date": "2022-10-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.6
      },
      {
        "date": "2022-11-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.6
      },
      {
        "date": "2022-12-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.7
      },
      {
        "date": "2023-01-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.5
      },
      {
        "date": "2023-02-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.5
      },
      {
        "date": "2023-03-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.5
      },
      {
        "date": "2023-04-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.3
      },
      {
        "date": "2023-05-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.6
      },
      {
        "date": "2023-06-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.4
      },
      {
        "date": "2023-07-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.3
      },
      {
        "date": "2023-08-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.3
      },
      {
        "date": "2023-09-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.3
      },
      {
        "date": "2023-10-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.3
      },
      {
        "date": "2023-11-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.3
      },
      {
        "date": "2023-12-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.1
      },
      {
        "date": "2024-01-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.1
      },
      {
        "date": "2024-02-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.2
      },
      {
        "date": "2024-03-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.1
      },
      {
        "date": "2024-04-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.2
      },
      {
        "date": "2024-05-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.1
      },
      {
        "date": "2024-06-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.1
      },
      {
        "date": "2024-07-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.1
      },
      {
        "date": "2024-08-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.0
      },
      {
        "date": "2024-09-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 1.9
      },
      {
        "date": "2024-10-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.0
      },
      {
        "date": "2024-11-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 1.9
      },
      {
        "date": "2024-12-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 1.9
      },
      {
        "date": "2025-01-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.0
      },
      {
        "date": "2025-02-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.0
      },
      {
        "date": "2025-03-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.1
      },
      {
        "date": "2025-04-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.0
      },
      {
        "date": "2025-05-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.0
      },
      {
        "date": "2025-06-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.0
      },
      {
        "date": "2025-07-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.0
      },
      {
        "date": "2025-08-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 1.9
      },
      {
        "date": "2025-09-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.0
      },
      {
        "date": "2025-10-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 1.9
      },
      {
        "date": "2025-11-01T00:00:00",
        "realtime_end": "2026-01-24",
        "realtime_start": "2026-01-24",
        "units": null,
        "value": 2.0
      }
    ]
  },
  "params": [
    {
      "bind": "scales",
      "name": "param_db82be42624d4632",
      "select": {
        "encodings": [
          "x"
        ],
        "type": "interval"
      },
      "views": [
        "view_248e4db49fb78b7e_1"
      ]
    }
  ],
  "title": {
    "anchor": "start",
    "color": "#2c3e50",
    "fontSize": 18,
    "fontWeight": "normal",
    "text": "Quits: Total Nonfarm"
  },
  "vconcat": [
    {
      "height": 300,
      "layer": [
        {
          "encoding": {
            "x": {
              "field": "date",
              "scale": {
                "domain": {
                  "param": "param_db82be42624d4632"
                }
              },
              "title": "",
              "type": "temporal"
            },
            "y": {
              "field": "value",
              "title": null,
              "type": "quantitative"
            }
          },
          "mark": {
            "color": "#2E86AB",
            "opacity": 0.12,
            "type": "area"
          }
        },
        {
          "encoding": {
            "x": {
              "axis": {
                "format": "%Y",
                "labelColor": "#555",
                "labelFontSize": 11
              },
              "field": "date",
              "scale": {
                "domain": {
                  "param": "param_db82be42624d4632"
                }
              },
              "title": "",
              "type": "temporal"
            },
            "y": {
              "field": "value",
              "title": null,
              "type": "quantitative"
            }
          },
          "mark": {
            "color": "#2E86AB",
            "strokeWidth": 3,
            "type": "line"
          }
        }
      ],
      "width": 800
    },
    {
      "encoding": {
        "x": {
          "axis": {
            "format": "%Y",
            "labelColor": "#666",
            "labelFontSize": 10
          },
          "field": "date",
          "title": "Drag to select date range",
          "type": "temporal"
        },
        "y": {
          "axis": null,
          "field": "value",
          "type": "quantitative"
        }
      },
      "height": 40,
      "mark": {
        "color": "#2E86AB",
        "strokeWidth": 1,
        "type": "line"
      },
      "name": "view_248e4db49fb78b7e_1",
      "width": 800
    }
  ]
};

        function computeAxisFormat(startISO, endISO){
            const start = new Date(startISO);
            const end = new Date(endISO);
            const days = (end - start) / (1000*60*60*24);
            if(days <= 90) return "%b %d, %Y"; // ~3 months -> show day
            if(days <= 365) return "%b %Y"; // ~1 year -> show month+year
            return "%Y"; // multi-year -> show year only
        }

        function toSpecWithRange(months){
            const spec = JSON.parse(JSON.stringify(originalSpec));
            if(!spec.params || !spec.params.length) return spec;
            if(months === 'all'){
                if(spec.params[0]) delete spec.params[0].value;
                // default to year ticks
                if(spec.vconcat && spec.vconcat.length>0){
                    spec.vconcat[0].layer.forEach(l => {
                        if(l.encoding && l.encoding.x && l.encoding.x.axis) l.encoding.x.axis.format = "%Y";
                    });
                    if(spec.vconcat[1] && spec.vconcat[1].encoding && spec.vconcat[1].encoding.x && spec.vconcat[1].encoding.x.axis) spec.vconcat[1].encoding.x.axis.format = "%Y";
                }
                updateRangeLabel(null, null);
                return spec;
            }
            const end = new Date();
            const start = new Date(end);
            start.setMonth(end.getMonth() - Number(months));
            const startISO = start.toISOString().slice(0,19);
            const endISO = end.toISOString().slice(0,19);
            spec.params[0].value = { x: [startISO, endISO] };
            const fmt = computeAxisFormat(startISO, endISO);
            // Apply axis format to main chart and timeline
            if(spec.vconcat && spec.vconcat.length>0){
                spec.vconcat[0].layer.forEach(l => {
                    if(l.encoding && l.encoding.x && l.encoding.x.axis) l.encoding.x.axis.format = fmt;
                });
                if(spec.vconcat[1] && spec.vconcat[1].encoding && spec.vconcat[1].encoding.x && spec.vconcat[1].encoding.x.axis) spec.vconcat[1].encoding.x.axis.format = fmt;
            }
            updateRangeLabel(startISO, endISO);
            return spec;
        }

        function formatShortDate(iso){
            if(!iso) return '';
            const d = new Date(iso);
            return d.toLocaleDateString(undefined, {year:'numeric', month:'short', day:'numeric'});
        }

        function updateRangeLabel(startISO, endISO){
            const el = document.getElementById('range-label');
            if(!el) return;
            if(!startISO || !endISO) { el.textContent = ''; return; }
            el.textContent = `Showing: ${formatShortDate(startISO)} â€” ${formatShortDate(endISO)}`;
        }

        function render(spec){
            vegaEmbed('#vis', spec, {
                actions: false,
                renderer: 'svg'
            }).catch(console.error);
        }

        // Hook up buttons
        document.addEventListener('DOMContentLoaded', () => {
            // Button active-state handling
            const buttons = document.querySelectorAll('#preset-buttons button');
            buttons.forEach(btn => {
                btn.addEventListener('click', () => {
                    buttons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    const r = btn.dataset.range;
                    const s = toSpecWithRange(r);
                    render(s);
                });
            });
            // default active for 'All'
            buttons[buttons.length-1].classList.add('active');

            // Initial render
            render(originalSpec);

            // Handle window resize by re-rendering current spec
            window.addEventListener('resize', () => {
                render(originalSpec);
            });
        });
    </script>
</body>
</html>